<!--<!DOCTYPE html>-->
<!--<html lang="ru" xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <link th:href="@{/css/sidebar.css}" rel="stylesheet">-->
<!--    <title>Изменение пароля</title>-->
<!--    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">-->
<!--    <style>-->
<!--        * {-->
<!--            margin: 0;-->
<!--            padding: 0;-->
<!--            box-sizing: border-box;-->
<!--        }-->

<!--        body {-->
<!--            font-family: Arial, sans-serif;-->
<!--            background-color: #f5f5f5;-->
<!--            display: flex;-->
<!--        }-->

<!--        .settings-header {-->
<!--            margin-bottom: 30px;-->
<!--        }-->

<!--        .settings-header h1 {-->
<!--            font-size: 24px;-->
<!--            color: #333;-->
<!--        }-->

<!--        .settings-card {-->
<!--            background: white;-->
<!--            border-radius: 15px;-->
<!--            padding: 25px;-->
<!--            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);-->
<!--            max-width: 500px;-->
<!--        }-->

<!--        .form-group {-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .form-group label {-->
<!--            display: block;-->
<!--            margin-bottom: 8px;-->
<!--            color: #333;-->
<!--            font-weight: 500;-->
<!--        }-->

<!--        .form-group input {-->
<!--            width: 100%;-->
<!--            padding: 10px;-->
<!--            border: 1px solid #ddd;-->
<!--            border-radius: 8px;-->
<!--            font-size: 16px;-->
<!--        }-->

<!--        .form-group input:focus {-->
<!--            outline: none;-->
<!--            border-color: #1da1f2;-->
<!--            box-shadow: 0 0 0 2px rgba(29, 161, 242, 0.1);-->
<!--        }-->

<!--        .btn {-->
<!--            background-color: #1da1f2;-->
<!--            color: white;-->
<!--            border: none;-->
<!--            border-radius: 8px;-->
<!--            padding: 12px 24px;-->
<!--            font-size: 16px;-->
<!--            cursor: pointer;-->
<!--            transition: background-color 0.2s;-->
<!--        }-->

<!--        .btn:hover {-->
<!--            background-color: #1a91da;-->
<!--        }-->

<!--        .back-link {-->
<!--            display: inline-flex;-->
<!--            align-items: center;-->
<!--            color: #666;-->
<!--            text-decoration: none;-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .back-link i {-->
<!--            margin-right: 8px;-->
<!--        }-->

<!--        .back-link:hover {-->
<!--            color: #1da1f2;-->
<!--        }-->

<!--        .alert {-->
<!--            padding: 12px;-->
<!--            border-radius: 8px;-->
<!--            margin-bottom: 20px;-->
<!--        }-->

<!--        .alert-success {-->
<!--            background-color: #d4edda;-->
<!--            color: #155724;-->
<!--            border: 1px solid #c3e6cb;-->
<!--        }-->

<!--        .alert-error {-->
<!--            background-color: #f8d7da;-->
<!--            color: #721c24;-->
<!--            border: 1px solid #f5c6cb;-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--&lt;!&ndash; Боковая панель &ndash;&gt;-->
<!--<div class="d-flex">-->
<!--    <div th:replace="~{fragments/sidebar :: sidebar}"></div>-->

<!--    &lt;!&ndash; Основной контент &ndash;&gt;-->
<!--    <main class="main-content">-->
<!--        <a href="/settings" class="back-link">-->
<!--            <i class="fas fa-arrow-left"></i>-->
<!--            Вернуться к настройкам-->
<!--        </a>-->

<!--        <div class="settings-header">-->
<!--            <h1>Изменение пароля</h1>-->
<!--        </div>-->

<!--        &lt;!&ndash; Сообщения об успехе или ошибке &ndash;&gt;-->
<!--        <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"></div>-->
<!--        <div th:if="${errorMessage}" class="alert alert-error" th:text="${errorMessage}"></div>-->

<!--        <div class="settings-card">-->
<!--            <form action="/settings/change-password" method="POST" th:object="${passwordForm}">-->
<!--                <div class="form-group">-->
<!--                    <label for="oldPassword">Текущий пароль</label>-->
<!--                    <input type="password"-->
<!--                           id="oldPassword"-->
<!--                           th:field="*{oldPassword}"-->
<!--                           required-->
<!--                           minlength="1">-->
<!--                </div>-->

<!--                <div class="form-group">-->
<!--                    <label for="newPassword">Новый пароль</label>-->
<!--                    <input type="password"-->
<!--                           id="newPassword"-->
<!--                           th:field="*{newPassword}"-->
<!--                           required-->
<!--                           minlength="8">-->
<!--                </div>-->

<!--                <div class="form-group">-->
<!--                    <label for="confirmPassword">Подтверждение нового пароля</label>-->
<!--                    <input type="password"-->
<!--                           id="confirmPassword"-->
<!--                           th:field="*{confirmPassword}"-->
<!--                           required-->
<!--                           minlength="8">-->
<!--                </div>-->

<!--                <button type="submit" class="btn">Изменить пароль</button>-->
<!--            </form>-->
<!--        </div>-->
<!--    </main>-->

<!--    <script>-->
<!--        // Проверка совпадения паролей-->
<!--        document.querySelector('form').addEventListener('submit', function (e) {-->
<!--            const newPassword = document.getElementById('newPassword').value;-->
<!--            const confirmPassword = document.getElementById('confirmPassword').value;-->

<!--            if (newPassword !== confirmPassword) {-->
<!--                e.preventDefault();-->
<!--                alert('Пароли не совпадают');-->
<!--            }-->
<!--        });-->
<!--    </script>-->
<!--</div>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link th:href="@{/css/sidebar.css}" rel="stylesheet">
    <title>Изменение пароля</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --background-dark: #000000;
            --secondary-bg: #16181c;
            --text-white: #e7e9ea;
            --text-gray: #71767b;
            --border-color: #2f3336;
            --blue-accent: #1d9bf0;
            --blue-hover: #1a8cd8;
            --error-color: #e0245e;
            --success-color: #00ba7c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--background-dark);
            color: var(--text-white);
        }

        .d-flex {
            display: flex;
            min-height: 100vh;
        }

        .main-content {
            flex: 1;
            padding: 30px;
            max-width: 800px;
            margin: 0 auto;
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-gray);
            text-decoration: none;
            padding: 10px;
            border-radius: 20px;
            transition: all 0.2s ease;
            margin-bottom: 30px;
        }

        .back-link:hover {
            background-color: rgba(239, 243, 244, 0.1);
            color: var(--blue-accent);
        }

        .back-link i {
            margin-right: 12px;
        }

        .settings-header {
            margin-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 20px;
        }

        .settings-header h1 {
            font-size: 28px;
            color: var(--text-white);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .settings-header h1 i {
            color: var(--blue-accent);
        }

        .settings-card {
            background: var(--secondary-bg);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .settings-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .form-group {
            margin-bottom: 24px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 10px;
            color: var(--text-white);
            font-weight: 500;
            font-size: 0.95rem;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            background-color: var(--background-dark);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-white);
            font-size: 16px;
            transition: all 0.2s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--blue-accent);
            box-shadow: 0 0 0 2px rgba(29, 161, 242, 0.1);
        }

        .password-toggle {
            position: absolute;
            right: 16px;
            top: 42px;
            color: var(--text-gray);
            cursor: pointer;
            transition: color 0.2s ease;
        }

        .password-toggle:hover {
            color: var(--blue-accent);
        }

        .btn {
            background-color: var(--blue-accent);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 14px 28px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
            margin-top: 10px;
        }

        .btn:hover {
            background-color: var(--blue-hover);
            transform: translateY(-1px);
        }

        .alert {
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 24px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .alert i {
            font-size: 20px;
        }

        .alert-success {
            background-color: rgba(0, 186, 124, 0.1);
            color: var(--success-color);
            border: 1px solid var(--success-color);
        }

        .alert-error {
            background-color: rgba(224, 36, 94, 0.1);
            color: var(--error-color);
            border: 1px solid var(--error-color);
        }

        .password-strength {
            margin-top: 8px;
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            overflow: hidden;
        }

        .password-strength-bar {
            height: 100%;
            width: 0;
            transition: width 0.3s ease, background-color 0.3s ease;
        }

        .password-requirements {
            margin-top: 8px;
            font-size: 0.85rem;
            color: var(--text-gray);
        }

        .requirement {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 4px;
        }

        .requirement i {
            font-size: 12px;
        }

        .requirement.met {
            color: var(--success-color);
        }
    </style>
</head>
<body>
<div class="d-flex">
    <div th:replace="~{fragments/sidebar :: sidebar}"></div>

    <main class="main-content">
        <a href="/settings" class="back-link">
            <i class="fas fa-arrow-left"></i>
            Вернуться к настройкам
        </a>

        <div class="settings-header">
            <h1>
                <i class="fas fa-key"></i>
                Изменение пароля
            </h1>
        </div>

        <div th:if="${successMessage}" class="alert alert-success">
            <i class="fas fa-check-circle"></i>
            <span th:text="${successMessage}"></span>
        </div>
        <div th:if="${errorMessage}" class="alert alert-error">
            <i class="fas fa-exclamation-circle"></i>
            <span th:text="${errorMessage}"></span>
        </div>

        <div class="settings-card">
            <form action="/settings/change-password" method="POST" th:object="${passwordForm}">
                <div class="form-group">
                    <label for="oldPassword">Текущий пароль</label>
                    <input type="password" id="oldPassword" th:field="*{oldPassword}" required>
                    <i class="fas fa-eye password-toggle" onclick="togglePassword('oldPassword')"></i>
                </div>

                <div class="form-group">
                    <label for="newPassword">Новый пароль</label>
                    <input type="password" id="newPassword" th:field="*{newPassword}" required minlength="8">
                    <i class="fas fa-eye password-toggle" onclick="togglePassword('newPassword')"></i>
                    <div class="password-strength">
                        <div class="password-strength-bar"></div>
                    </div>
                    <div class="password-requirements">
                        <div class="requirement" data-requirement="length">
                            <i class="fas fa-circle"></i>
                            Минимум 8 символов
                        </div>
                        <div class="requirement" data-requirement="number">
                            <i class="fas fa-circle"></i>
                            Минимум 1 цифра
                        </div>
                        <div class="requirement" data-requirement="special">
                            <i class="fas fa-circle"></i>
                            Минимум 1 специальный символ
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="confirmPassword">Подтверждение нового пароля</label>
                    <input type="password" id="confirmPassword" th:field="*{confirmPassword}" required>
                    <i class="fas fa-eye password-toggle" onclick="togglePassword('confirmPassword')"></i>
                </div>

                <button type="submit" class="btn">Изменить пароль</button>
            </form>
        </div>
    </main>
</div>

<script>
    function togglePassword(inputId) {
        const input = document.getElementById(inputId);
        const icon = input.nextElementSibling;

        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }

    // Проверка силы пароля
    const newPassword = document.getElementById('newPassword');
    const strengthBar = document.querySelector('.password-strength-bar');
    const requirements = document.querySelectorAll('.requirement');

    newPassword.addEventListener('input', function() {
        const password = this.value;
        let strength = 0;

        // Проверка требований
        const hasLength = password.length >= 8;
        const hasNumber = /\d/.test(password);
        const hasSpecial = /[!@#$%^&*(),.?":{}|<>]/.test(password);

        // Обновление индикаторов требований
        requirements.forEach(req => {
            const type = req.dataset.requirement;
            if ((type === 'length' && hasLength) ||
                (type === 'number' && hasNumber) ||
                (type === 'special' && hasSpecial)) {
                req.classList.add('met');
                req.querySelector('i').classList.remove('fa-circle');
                req.querySelector('i').classList.add('fa-check-circle');
            } else {
                req.classList.remove('met');
                req.querySelector('i').classList.add('fa-circle');
                req.querySelector('i').classList.remove('fa-check-circle');
            }
        });

        // Расчет силы пароля
        if (hasLength) strength += 33;
        if (hasNumber) strength += 33;
        if (hasSpecial) strength += 34;

        strengthBar.style.width = strength + '%';

        if (strength < 33) {
            strengthBar.style.backgroundColor = '#e0245e';
        } else if (strength < 66) {
            strengthBar.style.backgroundColor = '#ffd700';
        } else {
            strengthBar.style.backgroundColor = '#00ba7c';
        }
    });

    // Проверка совпадения паролей
    document.querySelector('form').addEventListener('submit', function(e) {
        const newPassword = document.getElementById('newPassword').value;
        const confirmPassword = document.getElementById('confirmPassword').value;

        if (newPassword !== confirmPassword) {
            e.preventDefault();
            const alert = document.createElement('div');
            alert.className = 'alert alert-error';
            alert.innerHTML = '<i class="fas fa-exclamation-circle"></i><span>Пароли не совпадают</span>';
            this.insertBefore(alert, this.firstChild);
        }
    });
</script>
</body>
</html>
